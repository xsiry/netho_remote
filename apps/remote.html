<link rel="stylesheet" type="text/css" href="../static/remote/style.css">
<div class="remote_main">
  <div class="remote_menus">
    <a href="javascript:void(0);">
      <div class="tbtn open_remote_btn">进桌面</div>
    </a>
    <a href="javascript:void(0);">
      <div class="tbtn game_download_btn">下游戏</div>
    </a>
  </div>
  <div class="remote_list_block">
    <div class="remote_list"></div>
    <div class="remote_add_mask" >
      <div class="remote_add_block">
        <form>
          <label>添加服务器</label>
          <div class="form-group">
            <input type="text" class="form-control" placeholder="服务器名称" required autofocus>
          </div>
          <div class="form-group">
            <input type="text" class="form-control" placeholder="外网IP" required>
          </div>
          <div class="form-group">
            <input type="text" class="form-control" placeholder="外网端口" required>
          </div>
          <div class="form-group">
            <input type="text" class="form-control" placeholder="内网IP" required>
          </div>
          <div class="form-group">
            <input type="text" class="form-control" placeholder="内网端口" required>
          </div>
          <div class="form-group">
            <input type="text" class="form-control" placeholder="登陆账号" required>
          </div>
          <div class="form-group">
            <input type="password" class="form-control" placeholder="登陆密码" required>
          </div>
          <button type="submit" class="btn btn-block btn-default">提交</button>
        </form>
      </div>
    </div>
  </div>
  <div class="game_download_block">
    2
  </div>
</div>
<script type="text/javascript">
$(document).ready(function() {
  seajs.use('../static/remote/src/main');

  var _initX; //触摸位置
  var _nowTouchObj;   //目标对象
  var _beforeTouchObj; //上一个对象

  $('.remote_list').on('touchstart', function(e) {
    //判断是否只有一个触摸点
    if(e.changedTouches.length==1){

        if (_beforeTouchObj) {
          _beforeTouchObj.css('-webkit-transform', "translateX(0px)");
          _beforeTouchObj = null;
        }
        var moveMax = $('.remote_tools').width(); //按钮区域宽度
        var movePadding = parseFloat($('.remote_tools').css('padding-left'));

        _nowTouchObj = $(e.target.parentNode.parentNode.parentNode);

        //记录触摸起始位置的X坐标
        _initX = e.changedTouches[0].clientX;

        _nowTouchObj.off('touchend').on('touchend', function(e) {
          if(e.changedTouches.length==1){
            //手指移动结束后触摸点位置的X坐标
            var endX = e.changedTouches[0].clientX;
            //触摸开始与结束，手指移动的距离
            var disX = _initX - endX;
            //如果距离小于删除按钮的1/2，不显示删除按钮
            var txtStyle = disX > (moveMax/2+movePadding) ? -moveMax : 0;

            if (_nowTouchObj.is(".list-li")) {
              _nowTouchObj.css('-webkit-transform', "translateX(" + txtStyle + "px)")
            }
            // $('.remote_list_block').css('overflow-y', 'auto');
            _beforeTouchObj = _nowTouchObj;
          }
        })
    }
  })

  $('.remote_list').on('touchmove', function(e) {
    if(e.changedTouches.length==1){
      var moveMax = $('.remote_tools').width(); //按钮区域宽度
      var movePadding = parseFloat($('.remote_tools').css('padding-left'));
      var moveX = e.changedTouches[0].clientX;
      //计算手指起始点的X坐标与当前触摸点的X坐标的差值
      var disX = _initX - moveX;
      var cssLeft = parseFloat(_nowTouchObj.css('left'));

      if(disX > movePadding) {
        // $('.remote_list_block').css('overflow-y', 'hidden');
      }

      var txtStyle = 0;
      if(disX < 0) {
        txtStyle = (Math.abs((disX + cssLeft)));
        if (txtStyle > 0){
          txtStyle = "0";
        }
      }else if(disX > 0 ){//移动距离大于0，文本层left值等于手指移动距离
        txtStyle = parseFloat(-disX);
        if(txtStyle <= parseFloat(-moveMax)){
          //控制手指移动距离最大值为删除按钮的宽度
          txtStyle = -moveMax;
        }
      }

      if (_nowTouchObj.is(".list-li")) {
        _nowTouchObj.css('-webkit-transform', "translateX(" + txtStyle + "px)");
      }
    }
  })
})
</script>
